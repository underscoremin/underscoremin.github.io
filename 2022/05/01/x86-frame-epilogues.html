<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Stack Frame Epilogues | underscoremin</title>
<meta name="generator" content="Jekyll v3.9.3" />
<meta property="og:title" content="Stack Frame Epilogues" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="On the x86 architecture, stack frames end with sequence of instructions inserted into the binary by the compiler, often referred to as the epilogue. The epilogue serves the purpose of: 1) Destroying the stack frame for the returning function, 2) Restoring the EBP register to contain the base pointer of the calling function which we are returning to. Typically the epilogue will look like so: ```nasm ; x86 Stack Frame Epilogue - Intel Syntax" />
<meta property="og:description" content="On the x86 architecture, stack frames end with sequence of instructions inserted into the binary by the compiler, often referred to as the epilogue. The epilogue serves the purpose of: 1) Destroying the stack frame for the returning function, 2) Restoring the EBP register to contain the base pointer of the calling function which we are returning to. Typically the epilogue will look like so: ```nasm ; x86 Stack Frame Epilogue - Intel Syntax" />
<link rel="canonical" href="/2022/05/01/x86-frame-epilogues" />
<meta property="og:url" content="/2022/05/01/x86-frame-epilogues" />
<meta property="og:site_name" content="underscoremin" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-05-01T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Stack Frame Epilogues" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-05-01T00:00:00+00:00","datePublished":"2022-05-01T00:00:00+00:00","description":"On the x86 architecture, stack frames end with sequence of instructions inserted into the binary by the compiler, often referred to as the epilogue. The epilogue serves the purpose of: 1) Destroying the stack frame for the returning function, 2) Restoring the EBP register to contain the base pointer of the calling function which we are returning to. Typically the epilogue will look like so: ```nasm ; x86 Stack Frame Epilogue - Intel Syntax","headline":"Stack Frame Epilogues","mainEntityOfPage":{"@type":"WebPage","@id":"/2022/05/01/x86-frame-epilogues"},"url":"/2022/05/01/x86-frame-epilogues"}</script>
<!-- End Jekyll SEO tag -->


<meta
  name="keywords"
  content="" />

<link rel="shortcut icon" href="/favicon.ico" />
<link rel="apple-touch-icon" href="/favicon.ico" />
<link
  rel="alternate"
  type="application/rss+xml"
  title="underscoremin - Mini security posts. "
  href="/feed.xml" />
<link
  rel="stylesheet"
  type="text/css"
  href="/assets/css/base.css" />
<link
  rel="stylesheet"
  type="text/css"
  href="/assets/css/highlight.css" />

<!--[if lt IE 9]>
  <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->

<script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
<script>
    mermaid.initialize(
        {
            startOnLoad: true,
            theme: "base",
			'themeVariables': {
				'primaryColor': '#ba91ed',
			    'primaryTextColor': '#fff',
			    'primaryBorderColor': '#2b0061',
			    'lineColor': '#2b0061',
			    'secondaryColor': '#eae4ef',
			    'tertiaryColor': '#f2e8ff',
			    'tertiaryBorderColor': '#2b0061',
                'darkMode': true,
            },
            flowchart: {
                diagramPadding: 30,
                rankSpacing: 100,
                padding: 7,
                useMaxWidth: true
            }
        }

    );
</script>

<script
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"
  async>
</script>



  </head>
  <body>
    <div class="container-wrapper">
      <header class="container-header">
        <div class="header-info">
  <span class="header-info-name">underscoremin</span>
  <span class="header-info-desc">Mini security posts. </span>
</div>
<nav class="header-nav">
  <ul class="header-main-nav">
    
    <li class="header-main-nav-item">
      <a href="/">
        
          Index
        
      </a>
    </li>
    
    <li class="header-main-nav-item">
      <a href="/categories">
        
          Categories
        
      </a>
    </li>
    
    <li class="header-main-nav-item">
      <a href="/about">
        
          About
        
      </a>
    </li>
    
  </ul>
</nav>

      </header>
      <main class="container-main">
        <article class="container-post">
  <div class="post-title">
    <h1>Stack Frame Epilogues</h1>
  </div>
  
  <div class="post-author print-post-author">
    <span>_min</span>
  </div>
  
  <div class="post-content">
    <p><br /> 
On the x86 architecture, 
<a href="/2022/05/01/x86-stack-frames">stack frames</a> end with sequence of 
instructions inserted into the binary by the compiler, often referred to as the 
<em>epilogue</em>. The epilogue serves the purpose of:<br />
<br />
1) Destroying the stack frame for the returning function,<br />
2) Restoring the EBP register to contain the 
<a href="/2022/05/01/x86-base-pointer">base pointer</a> of the calling 
function which we are returning to. <br />
<br /> 
Typically the epilogue will look like so:</p>
<div class="language-nasm highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">; x86 Stack Frame Epilogue - Intel Syntax</span>

<span class="nf">leave</span>
<span class="nf">ret</span>
</code></pre></div></div>
<p><br /> 
The <a href="/2022/05/01/x86-leave-instruction">leave</a> instruction will 
tear down the stack frame and restore the saved frame pointer to get ready to 
return to the calling function. The 
<a href="/2022/05/01/x86-ret-instruction">ret</a> instruction will continue 
execution back to the <em>return address</em> which is now located at the top of the 
stack (i.e. ESP is pointing to the return address) and was placed there during 
the original <em>call</em> instruction to the function we are about to exit.</p>

  </div>
  <div class="post-info">
    <div class="post-date">
      Written on 
      2022-05-01
      
      .
    </div>
    
    <div class="post-author">
      Author: _min
    </div>
    
    <div class="post-categories">
      <span>Categories: </span>
      
      <a 
        href="/categories#x86"
        class="post-category">
        x86
      </a>
      
    </div>
    <div class="post-tags">
      <span>Tags: </span>
      
    </div>
    <div class="post-other">
      
      <div>
        <span>
          Next: 
        </span>
        <a href="/2022/05/01/x86-frame-prologues">
          Stack Frame Prologues
        </a>
      </div>
      
      
      <div>
        <span>
          Previous: 
        </span>
        <a href="/2022/05/01/x86-base-pointer">
          Base Pointers (Frame Pointers)
        </a>
      </div>
      
    </div>
    
  </div>
</article>

      </main>
      <footer class="container-footer">
        <div class="footer-copyright">
  <span class="footer-copyright-text float-left">
  </span>
</div>

      </footer>
    </div>
  </body>
</html>
